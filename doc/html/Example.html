<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>iSAM: Simple iSAM Example</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">iSAM
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('Example.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Simple iSAM Example </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The iSAM library represents general optimization problems as a factor graph, where nodes represent variables and factors represent measurements on sets of one or more nodes.</p>
<p>In this simple SLAM example, five poses are created and connected into a chain by odometry measurements. A landmark is added with a single measurement from one of the poses.</p>
<p>Note that the optimization problem described so far is not fully constrained as the complete graph can be shifted and rotated arbitrarily in the plane without changing the relative measurements described by odometry and landmark measurements. The graph needs to be constraints, and a common solution is to add a prior to the first pose to fix it at the origin.</p>
<p>The following code can be compiled and run with </p><pre class="fragment">make examples
bin/example
</pre><p>To compile without the iSAM cmake system: </p><pre class="fragment">cd examples
c++ example.cpp ../lib/libisam.a -lcholmod -I../include -I/usr/include/eigen3
</pre><p><a class="el" href="example_8cpp.html" title="Simple iSAM example with dynamic allocation. ">examples/example.cpp</a> : </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="isam_8h.html">isam/isam.h</a>&gt;</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacestd.html">std</a>;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespaceisam.html">isam</a>;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespaceEigen.html">Eigen</a>;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="keywordtype">int</span> main() {</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="comment">// instance of the main class that manages and optimizes the pose graph</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <a class="code" href="classisam_1_1Slam.html">Slam</a> slam;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="comment">// locally remember poses</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  vector&lt;Pose2d_Node*&gt; pose_nodes;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <a class="code" href="classisam_1_1Noise.html">Noise</a> noise3 = <a class="code" href="classisam_1_1Information.html">Information</a>(100. * <a class="code" href="util_8h.html#a71cf56105b586a9d7ebe66196bda99d6">eye</a>(3));</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <a class="code" href="classisam_1_1Noise.html">Noise</a> noise2 = <a class="code" href="classisam_1_1Information.html">Information</a>(100. * <a class="code" href="util_8h.html#a71cf56105b586a9d7ebe66196bda99d6">eye</a>(2));</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="comment">// create a first pose (a node)</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <a class="code" href="classisam_1_1NodeT.html">Pose2d_Node</a>* new_pose_node = <span class="keyword">new</span> <a class="code" href="classisam_1_1NodeT.html">Pose2d_Node</a>();</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="comment">// add it to the graph</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  slam.<a class="code" href="classisam_1_1Slam.html#a3bc8318efd9a16dd7d26e427ede2b5d9">add_node</a>(new_pose_node);</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="comment">// also remember it locally</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  pose_nodes.push_back(new_pose_node);</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="comment">// create a prior measurement (a factor)</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <a class="code" href="classisam_1_1Pose2d.html">Pose2d</a> origin(0., 0., 0.);</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <a class="code" href="classisam_1_1Pose2d__Factor.html">Pose2d_Factor</a>* prior = <span class="keyword">new</span> <a class="code" href="classisam_1_1Pose2d__Factor.html">Pose2d_Factor</a>(pose_nodes[0], origin, noise3);</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="comment">// add it to the graph</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  slam.<a class="code" href="classisam_1_1Slam.html#a0ffd2e7661643d9484e781ed1b2e85fa">add_factor</a>(prior);</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i&lt;4; i++) {</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="comment">// next pose</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <a class="code" href="classisam_1_1NodeT.html">Pose2d_Node</a>* new_pose_node = <span class="keyword">new</span> <a class="code" href="classisam_1_1NodeT.html">Pose2d_Node</a>();</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    slam.<a class="code" href="classisam_1_1Slam.html#a3bc8318efd9a16dd7d26e427ede2b5d9">add_node</a>(new_pose_node);</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    pose_nodes.push_back(new_pose_node);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="comment">// connect to previous with odometry measurement</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="classisam_1_1Pose2d.html">Pose2d</a> odometry(1., 0., 0.); <span class="comment">// x,y,theta</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <a class="code" href="classisam_1_1Pose2d__Pose2d__Factor.html">Pose2d_Pose2d_Factor</a>* constraint = <span class="keyword">new</span> <a class="code" href="classisam_1_1Pose2d__Pose2d__Factor.html">Pose2d_Pose2d_Factor</a>(pose_nodes[i-1], pose_nodes[i], odometry, noise3);</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    slam.<a class="code" href="classisam_1_1Slam.html#a0ffd2e7661643d9484e781ed1b2e85fa">add_factor</a>(constraint);</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  }</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="comment">// create a landmark</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <a class="code" href="classisam_1_1NodeT.html">Point2d_Node</a>* new_point_node = <span class="keyword">new</span> <a class="code" href="classisam_1_1NodeT.html">Point2d_Node</a>();</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  slam.<a class="code" href="classisam_1_1Slam.html#a3bc8318efd9a16dd7d26e427ede2b5d9">add_node</a>(new_point_node);</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="comment">// create a pose and the landmark by a measurement</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <a class="code" href="classisam_1_1Point2d.html">Point2d</a> measure(5., 3.); <span class="comment">// x,y</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <a class="code" href="classisam_1_1Pose2d__Point2d__Factor.html">Pose2d_Point2d_Factor</a>* measurement =</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keyword">new</span> <a class="code" href="classisam_1_1Pose2d__Point2d__Factor.html">Pose2d_Point2d_Factor</a>(pose_nodes[1], new_point_node, measure, noise2);</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  slam.<a class="code" href="classisam_1_1Slam.html#a0ffd2e7661643d9484e781ed1b2e85fa">add_factor</a>(measurement);</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="comment">// optimize the graph</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  slam.<a class="code" href="classisam_1_1Slam.html#afd2d6a058f2212757ba7c3f46d66ac16">batch_optimization</a>();</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="comment">// accessing the current estimate of a specific pose</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  cout &lt;&lt; <span class="stringliteral">&quot;Pose 2: &quot;</span> &lt;&lt; pose_nodes[2]-&gt;value() &lt;&lt; endl;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="comment">// printing the complete graph</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;Full graph:&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  slam.write(cout);</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;}</div><div class="ttc" id="classisam_1_1Slam_html"><div class="ttname"><a href="classisam_1_1Slam.html">isam::Slam</a></div><div class="ttdef"><b>Definition:</b> <a href="Slam_8h_source.html#l00066">Slam.h:66</a></div></div>
<div class="ttc" id="classisam_1_1Pose2d_html"><div class="ttname"><a href="classisam_1_1Pose2d.html">isam::Pose2d</a></div><div class="ttdef"><b>Definition:</b> <a href="Pose2d_8h_source.html#l00043">Pose2d.h:43</a></div></div>
<div class="ttc" id="classisam_1_1Noise_html"><div class="ttname"><a href="classisam_1_1Noise.html">isam::Noise</a></div><div class="ttdef"><b>Definition:</b> <a href="Noise_8h_source.html#l00036">Noise.h:36</a></div></div>
<div class="ttc" id="classisam_1_1Point2d_html"><div class="ttname"><a href="classisam_1_1Point2d.html">isam::Point2d</a></div><div class="ttdef"><b>Definition:</b> <a href="Point2d_8h_source.html#l00038">Point2d.h:38</a></div></div>
<div class="ttc" id="classisam_1_1Slam_html_a3bc8318efd9a16dd7d26e427ede2b5d9"><div class="ttname"><a href="classisam_1_1Slam.html#a3bc8318efd9a16dd7d26e427ede2b5d9">isam::Slam::add_node</a></div><div class="ttdeci">void add_node(Node *node)</div><div class="ttdef"><b>Definition:</b> <a href="Slam_8cpp_source.html#l00091">Slam.cpp:91</a></div></div>
<div class="ttc" id="namespaceEigen_html"><div class="ttname"><a href="namespaceEigen.html">Eigen</a></div><div class="ttdef"><b>Definition:</b> <a href="Node_8h_source.html#l00035">Node.h:35</a></div></div>
<div class="ttc" id="namespaceisam_html"><div class="ttname"><a href="namespaceisam.html">isam</a></div><div class="ttdef"><b>Definition:</b> <a href="Anchor_8h_source.html#l00038">Anchor.h:38</a></div></div>
<div class="ttc" id="namespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div><div class="ttdoc">STL namespace. </div></div>
<div class="ttc" id="classisam_1_1Slam_html_a0ffd2e7661643d9484e781ed1b2e85fa"><div class="ttname"><a href="classisam_1_1Slam.html#a0ffd2e7661643d9484e781ed1b2e85fa">isam::Slam::add_factor</a></div><div class="ttdeci">void add_factor(Factor *factor)</div><div class="ttdef"><b>Definition:</b> <a href="Slam_8cpp_source.html#l00096">Slam.cpp:96</a></div></div>
<div class="ttc" id="util_8h_html_a71cf56105b586a9d7ebe66196bda99d6"><div class="ttname"><a href="util_8h.html#a71cf56105b586a9d7ebe66196bda99d6">isam::eye</a></div><div class="ttdeci">Eigen::MatrixXd eye(int num)</div><div class="ttdef"><b>Definition:</b> <a href="util_8cpp_source.html#l00110">util.cpp:110</a></div></div>
<div class="ttc" id="classisam_1_1Pose2d__Pose2d__Factor_html"><div class="ttname"><a href="classisam_1_1Pose2d__Pose2d__Factor.html">isam::Pose2d_Pose2d_Factor</a></div><div class="ttdef"><b>Definition:</b> <a href="slam2d_8h_source.html#l00130">slam2d.h:130</a></div></div>
<div class="ttc" id="isam_8h_html"><div class="ttname"><a href="isam_8h.html">isam.h</a></div><div class="ttdoc">Main isam header file. </div></div>
<div class="ttc" id="classisam_1_1Slam_html_afd2d6a058f2212757ba7c3f46d66ac16"><div class="ttname"><a href="classisam_1_1Slam.html#afd2d6a058f2212757ba7c3f46d66ac16">isam::Slam::batch_optimization</a></div><div class="ttdeci">virtual int batch_optimization()</div><div class="ttdef"><b>Definition:</b> <a href="Slam_8cpp_source.html#l00198">Slam.cpp:198</a></div></div>
<div class="ttc" id="classisam_1_1Information_html"><div class="ttname"><a href="classisam_1_1Information.html">isam::Information</a></div><div class="ttdef"><b>Definition:</b> <a href="Noise_8h_source.html#l00049">Noise.h:49</a></div></div>
<div class="ttc" id="classisam_1_1Pose2d__Point2d__Factor_html"><div class="ttname"><a href="classisam_1_1Pose2d__Point2d__Factor.html">isam::Pose2d_Point2d_Factor</a></div><div class="ttdef"><b>Definition:</b> <a href="slam2d_8h_source.html#l00286">slam2d.h:286</a></div></div>
<div class="ttc" id="classisam_1_1Pose2d__Factor_html"><div class="ttname"><a href="classisam_1_1Pose2d__Factor.html">isam::Pose2d_Factor</a></div><div class="ttdef"><b>Definition:</b> <a href="slam2d_8h_source.html#l00087">slam2d.h:87</a></div></div>
<div class="ttc" id="classisam_1_1NodeT_html"><div class="ttname"><a href="classisam_1_1NodeT.html">isam::NodeT</a></div><div class="ttdef"><b>Definition:</b> <a href="Node_8h_source.html#l00099">Node.h:99</a></div></div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Feb 27 2020 15:13:08 for iSAM by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
