<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>iSAM: iSAM in Depth</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">iSAM
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('Tutorial.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">iSAM in Depth </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="tutorial_history"></a>
History</h1>
<p>iSAM is my Ph.D. dissertation work that was advised by Frank Dellaert at the Georgia Institute of Technology. Back in 2005 I worked on data association and needed marginal covariances for the SLAM problem. Calculating those in the naive way yielded hour-long waiting times even for relatively small problems. At that time I got interested in ongoing work by Frank called Square Root SAM and finally helped with the experiments of the IJRR 2006 paper. Together with Ananth Ranganathan we figured out a way of recovering arbitrary parts of the full covariance matrix from the square root information factor that Square Root SAM calculates. However, calculating that square root information matrix itself from scratch eventually becomes expensive for larger problems. Instead, I started to incrementally update the square root information matrix, which is advantageous because most of the time new measurements only affect a small part of the variables of the SLAM problem. We eventually selected Givens rotations as a simple mechanism to update a QR matrix factorization, which gave rise to the iSAM algorithm, first published in IJCAI in January 2007.</p>
<h1><a class="anchor" id="tutorial_fg"></a>
SLAM as a Factor Graph</h1>
<p>In the iSAM library, we represent the SLAM problem as a factor graph. A factor graph is a bipartite graph that contains two types of nodes: variable nodes and factor nodes. Edges are only allowed between different types of nodes, i.e. they always connect a node with a factor. Here is an example of a factor graph representing a simple SLAM problem:</p>
<div class="image">
<img src="factor_graph.png" alt="factor_graph.png"/>
</div>
<p>Colored circles represent variable nodes, and small solid black circles represent factor nodes. Robot poses x_i are marked blue and are connected by a chain of odometry measurements u_i. Other constraints, for example derived from laser scan-matching are not necessarily connecting subsequent poses, but can also encode loop closing constraints. So far the SLAM problem represents a so-called pose graph, consisting only of poses and constraints.</p>
<p>SLAM can also contain landmarks, here the landmark locations l_j shown in green. Landmark observations u_k are also represented by factors. Landmarks can for example be observed by laser range finders or cameras. The resulting optimization problem is referred to as bundle adjustment in photogrammetry and as structure from motion in computer vision.</p>
<p>While this example can readily be represented as a Bayes net, as typically found in the SLAM literature, more complicated scenarios are more easily represented as factor graphs. For example, the calibration of a sensor can be represented by another node that connects to all relevant factors. A more advanced example is provided by the concept of anchor nodes, see <a class="el" href="Tutorial.html#tutorial_anchor">anchor nodes</a>.</p>
<p>For a code example, please see the <a class="el" href="Example.html">Simple iSAM Example</a>.</p>
<h1><a class="anchor" id="tutorial_important"></a>
Most Important Classes</h1>
<p>The <a class="el" href="classisam_1_1Slam.html">isam::Slam</a> class in <a class="el" href="Slam_8h.html" title="SLAM implementation using iSAM. ">Slam.h</a> represents the factor graph, providing methods for creating the graph as well as optimizing. Of particular interest are the methods <a class="el" href="classisam_1_1Slam.html#a3bc8318efd9a16dd7d26e427ede2b5d9">isam::Slam::add_node()</a> and <a class="el" href="classisam_1_1Slam.html#a0ffd2e7661643d9484e781ed1b2e85fa">isam::Slam::add_factor()</a> that are needed to incrementally build the SLAM graph. Suitable nodes and factors for 2D SLAM problems can be found in <a class="el" href="slam2d_8h.html" title="Provides specialized nodes and factors for 2D SLAM. ">slam2d.h</a>. The method <a class="el" href="classisam_1_1Slam.html#aa1dc0e80516324af073d26238d4a4f8b">isam::Slam::update()</a> performs the necessary calculations to obtain a new estimate, and is typically called after all factors of a time step are added. The detailed behavior of the algorithm can be controlled through isam::Slam::update_properties().</p>
<h1><a class="anchor" id="tutorial_init"></a>
Automatic and Manual Initialization of Nodes</h1>
<p>In many cases the iSAM library can automatically generate initial estimates for new nodes based on the first measurement that gets connected to the node. For odometry, for example, the current estimate of the previous pose together with the odometry measurement provides the initialization of the new pose. In other situations, such as when partial constraints are being added (eg. stereo measurements), multiple measurements might be needed to constrain the new variable (eg. camera pose). In that case the user can provide the initialization that was for example obtained by a RANSAC algorithm with 5-point algorithm. In that case the user can call isam::Node::init() with the appropriate estimate.</p>
<h1><a class="anchor" id="tutorial_factors"></a>
Defining New Factors and Nodes</h1>
<p>New types of factors can easily be defined by the user. Examples of factors are provided in <a class="el" href="slam2d_8h.html" title="Provides specialized nodes and factors for 2D SLAM. ">slam2d.h</a>. The user simply creates a new class derived from Factor and defines a cost function. To allow fast prototyping, iSAM by default uses numerical differentiation. For time-critical implementations, the user can optionally provide a symbolic derivative by overwriting isam::Factor::jacobian.</p>
<p>New types of nodes can also be defined by the user. Good examples of nodes are Point2d (simple) and Pose3d (more advanced). The user simply creates a new class that contains the variables to be optimized as well as an exponential map. In many cases the exponential map simply adds a delta vector to the variable. However, when dealing with overparametrized representations such as Quaternions, rotation matrices and homogeneous points (see Rot3d and Point3dh), the exponential map allows using a minimal representation within the optimization. The minimal representation is only needed locally for updates, while a global minimal representation might not be available or suitable for this purpose.</p>
<h1><a class="anchor" id="tutorial_covs"></a>
Marginal Covariances</h1>
<p>A key advantage of iSAM is the efficient access to the exact marginal covariances. See <a class="el" href="covariances_8cpp.html" title="How to recover covariances. ">examples/covariances.cpp</a> for how to access selected parts of the full marginal covariance matrix. Note that recovering the full marginal covariance is infeasible for large problems, independent of the algorithm used, as the matrix itself contains O(n^2) entries that would have to be calculated.</p>
<h1><a class="anchor" id="tutorial_anchor"></a>
Anchor Nodes and Multi-Robot/Session Mapping</h1>
<p>We have recently presented a novel approach to multi-robot or multi-session mapping. An implementation of anchor nodes is included in iSAM, for usage see <a class="el" href="anchorNodes_8cpp.html" title="Multiple relative pose graphs with relative constraints. ">examples/anchorNodes.cpp</a>.</p>
<div class="image">
<img src="anchor_nodes.png" alt="anchor_nodes.png"/>
</div>
<p>The figure shows three robot trajectories that are not synchronized, and do not require initial relative pose estimates. Encounters later define the alignment of the trajectories in a common frame. For more details please refer to:</p>
<ul>
<li>"Multiple Relative Pose Graphs for Robust Cooperative Mapping" by B. Kim, M. Kaess, L. Fletcher, J. Leonard, A. Bachrach, N. Roy, S. Teller, IEEE Intl. Conf. on Robotics and Automation (ICRA), May 2010, <a href="http://www.cc.gatech.edu/~kaess/pub/Kim10icra.pdf" target="_top">PDF</a></li>
</ul>
<h1><a class="anchor" id="tutorial_conventions"></a>
General Comments</h1>
<ul>
<li>A file A.cpp contains "class A" (<a class="el" href="Slam_8h.html" title="SLAM implementation using iSAM. ">Slam.h</a>), while a.cpp contains non-class functions (<a class="el" href="util_8cpp.html" title="Basic utility functions that are independent of iSAM. ">util.cpp</a>) or collections of classes (<a class="el" href="slam2d_8h.html" title="Provides specialized nodes and factors for 2D SLAM. ">slam2d.h</a>).</li>
<li>The CHOLMOD library is used for efficiency in sparse batch factorization.</li>
<li>The custom class SparseSystem is used for incremental updates, as updates are expensive for the usual compressed storage.</li>
<li>Only on some computers, simply linking with GLUT/GL slows down the isam executable by 50%, even when no GLUT functions are called; therefore, set USE_GUI to OFF for timing. </li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Feb 27 2020 15:13:08 for iSAM by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
